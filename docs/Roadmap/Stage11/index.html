<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Roadmap/Stage11">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Stage 11: Index Creation and Deletion | NITCbase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nitcbase.github.io/docs/Roadmap/Stage11"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Stage 11: Index Creation and Deletion | NITCbase"><meta data-rh="true" name="description" content="- Implement the creation and insertion operations on a B+ tree on the XFS disk"><meta data-rh="true" property="og:description" content="- Implement the creation and insertion operations on a B+ tree on the XFS disk"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://nitcbase.github.io/docs/Roadmap/Stage11"><link data-rh="true" rel="alternate" href="https://nitcbase.github.io/docs/Roadmap/Stage11" hreflang="en"><link data-rh="true" rel="alternate" href="https://nitcbase.github.io/docs/Roadmap/Stage11" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/feedback/rss.xml" title="NITCbase RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/feedback/atom.xml" title="NITCbase Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1927f7db.css">
<link rel="preload" href="/assets/js/runtime~main.03501c79.js" as="script">
<link rel="preload" href="/assets/js/main.39433d22.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="NITCbase" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="NITCbase" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">NITCbase</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Roadmap/">Roadmap</a><a class="navbar__item navbar__link" href="/docs/Design/Architecture">Design</a><a class="navbar__item navbar__link" href="/docs/User Interface Commands/">Commands</a><a class="navbar__item navbar__link" href="/docs/Misc/">Miscellaneous</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/feedback">Feedback</a><a class="navbar__item navbar__link" href="/AboutUs">About Us</a><a href="https://github.com/nitcbase" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.svg" alt="NITCbase" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="NITCbase" class="themedImage_ToTc themedImage--dark_i4oU"><b>NITCbase</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage00">Stage 0 : Installation and Preparation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage01">Stage 1 : Understanding the Disk Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage02">Stage 2: Record Blocks and Catalogs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage03">Stage 3 : The Disk Buffer and Catalog Caches</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage04">Stage 4 : Linear Search on Relations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage05">Stage 5 : Opening Relations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage06">Stage 6 : Buffer Management and Disk Write-back</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage07">Stage 7 : Inserting Records Into Relations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage08">Stage 8 : Creating and Deleting Relations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage09">Stage 9 : Selection and Projection on Relations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage10">Stage 10: B+ Tree Search on Relations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/Roadmap/Stage11">Stage 11: Index Creation and Deletion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Roadmap/Stage12">Stage 12: Join on Relations</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Stage 11: Index Creation and Deletion (30 hours)</h1><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Learning Objectives</div><div class="admonitionContent_S0QG"><ul><li>Implement the creation and insertion operations on a B+ tree on the XFS disk</li><li>Implement the deletion of an index from the XFS disk</li></ul></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>PREREQUISITE READING</div><div class="admonitionContent_S0QG"><ul><li><a href="/docs/Misc/B+ Trees">B+ Trees</a></li><li><a href="/docs/Misc/Indexing">Indexing in NITCbase</a></li></ul></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>You must now already be familiar with the usage of indexes to speed up search operations. An index can be created on any attribute of a relation using the <a href="/docs/User Interface Commands/ddl#create-index">CREATE INDEX</a> command. Once an index is created on the attribute, all search operations involving that attribute will proceed through the index instead of a linear search through all the records. An index can be deleted with the <a href="/docs/User Interface Commands/ddl#drop-index">DROP INDEX</a> command. Note that NITCbase does not allow you to create/delete indexes for the relation catalog and the attribute catalog.</p><p>Thus far, index creation and deletion could only be done through the XFS Interface. In this stage, we will implement this functionality in NITCbase.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementation">Implementation<a href="#implementation" class="hash-link" aria-label="Direct link to Implementation" title="Direct link to Implementation">​</a></h2><p>When an index is created for an attribute of a relation, the <code>RootBlock</code> field in the corresponding attribute catalog entry will have to be updated with the block number of the root block of the B+ tree. In practice, this value is updated in the attribute cache and then written back to the buffer (and subsequently the disk) when the relation is closed. Thus, we will need to implement attribute cache update and write back in the <a href="/docs/Design/Cache Layer/intro">Cache Layer</a>.</p><p>In the <a href="/docs/Design/Buffer Layer/intro">Buffer Layer</a>, we will need to update the <a href="/docs/Design/Buffer Layer/IndBuffer#class-indleaf">IndLeaf</a> and <a href="/docs/Design/Buffer Layer/IndBuffer#class-indinternal">IndInternal</a> classes to implement the <code>setEntry()</code> function we discussed in the previous stage. This function allows us to write to an index block.</p><p>A sequence diagram showing the call sequence involved in the implementation of index creation and deletion are shown below.</p><blockquote><p><strong>NOTE</strong>: The functions are denoted with circles as follows.<br>
🔵 -&gt; methods that are already in their final state<br>
🟢 -&gt; methods that will attain their final state in this stage<br></p></blockquote><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cache-update-and-write-back">Cache Update and Write-back<a href="#cache-update-and-write-back" class="hash-link" aria-label="Direct link to Cache Update and Write-back" title="Direct link to Cache Update and Write-back">​</a></h3><p>An index can only be created for an open relation. When an index is created for a relation on an attribute, the <code>RootBlock</code> field is set for the corresponding <strong>attribute catalog entry in the attribute cache entry</strong> of the relation. Similar to how we had implemented the updation of the relation cache in previous stages, this updated value will be written to the buffer when the relation is closed (or at system exit, when all open relations are closed.).</p><p>Thus, we will need to implement methods to write to the attribute cache. Additionally, we will also modify the <code>OpenRelTable::closeRel()</code> function to write-back any <em>dirty</em> attribute cache entries on relation closing. Note that we do not need to update the destructor of the OpenRelTable class to handle write-back for the attribute cache entries of the relation catalog and the attribute catalog (why?).</p><p>A class diagram of the <a href="/docs/Design/Cache Layer/intro">Cache Layer</a> highlighting the methods relevant to this functionality is shown below.</p><br><p>In class <code>AttrCacheTable</code>, we implement the method <code>setAttrCatEntry()</code> which is overloaded to find the entry in the attribute cache using the attribute&#x27;s name or offset.</p><p>We also implement the <code>attrCatEntryToRecord()</code> function which converts from a <a href="/docs/Design/Cache Layer/intro#attrcatentry">struct AttrCatEntry</a> to a record of the attribute catalog (a <a href="/docs/Design/Buffer Layer/intro#attribute">union Attribute</a> array). This function will be useful when writing the dirty cache entry back to the buffer in record form.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Cache/AttrCacheTable.cpp</summary><div><div class="collapsibleContent_i85q"><p>Implement the following functions looking at their respective design docs</p><ul><li><a href="/docs/Design/Cache Layer/AttrCacheTable#attrcachetable--setattrcatentry"><code>AttrCacheTable::setAttrCatEntry(relId, attrOffset, attrCatEntry)</code></a></li><li><a href="/docs/Design/Cache Layer/AttrCacheTable#attrcachetable--setattrcatentry"><code>AttrCacheTable::setAttrCatEntry(relId, attrName, attrCatEntry)</code></a></li><li><a href="/docs/Design/Cache Layer/AttrCacheTable#attrcachetable--attrcatentrytorecord"><code>AttrCacheTable::attrCatEntryToRecord()</code></a></li></ul></div></div></details><p>In class <code>OpenRelTable</code>, we update <code>closeRel()</code> to check for dirty attribute cache entries and write them back to the buffer using <code>attrCatEntryToRecord()</code> and the <a href="/docs/Design/Buffer Layer/intro">Buffer Layer</a> functions we are familiar with.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Cache/OpenRelTable.cpp</summary><div><div class="collapsibleContent_i85q"><p>Implement the <code>OpenRelTable::closeRel()</code> function by looking at the <a href="/docs/Design/Cache Layer/OpenRelTable#openreltable--closerel">design docs</a>.</p></div></div></details><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="writing-to-index-blocks">Writing to Index Blocks<a href="#writing-to-index-blocks" class="hash-link" aria-label="Direct link to Writing to Index Blocks" title="Direct link to Writing to Index Blocks">​</a></h3><p>In the previous stage, we had talked about the abstract class <a href="/docs/Design/Buffer Layer/IndBuffer#class-indbuffer">IndBuffer</a> and it&#x27;s children <a href="/docs/Design/Buffer Layer/IndBuffer#class-indleaf">IndLeaf</a> and <a href="/docs/Design/Buffer Layer/IndBuffer#class-indinternal">IndInternal</a> representing leaf index blocks and internal index blocks respectively. We had implemented the <code>getEntry()</code> function in both the classes to read an entry from an index block. In this stage, we will implement the <code>setEntry()</code> function which allows us to write an entry to an index block.</p><p>A class diagram of the <a href="/docs/Design/Buffer Layer/intro">Buffer Layer</a> highlighting these functions is shown below.</p><br><p>Implement these functions as shown in the links below.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Buffer/BlockBuffer.cpp</summary><div><div class="collapsibleContent_i85q"><p>Implement the following functions looking at their respective design docs</p><ul><li><a href="/docs/Design/Buffer Layer/IndBuffer#indleaf--setentry"><code>IndLeaf::setEntry()</code></a></li><li><a href="/docs/Design/Buffer Layer/IndBuffer#indinternal--setentry"><code>IndInternal::setEntry()</code></a></li></ul></div></div></details><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="creating-and-deleting-b-trees">Creating and Deleting B+ Trees<a href="#creating-and-deleting-b-trees" class="hash-link" aria-label="Direct link to Creating and Deleting B+ Trees" title="Direct link to Creating and Deleting B+ Trees">​</a></h3><p>In the <a href="/docs/Design/B+ Tree Layer">B+ Tree Layer</a>, we implement methods to create a B+ tree, insert into a B+ tree and free all the index blocks associated with a B+ tree. Note that we do not need to implement the functionality to delete an individual entry from a B+ tree because NITCbase does not support individual deletion of records.</p><p>A class diagram highlighting all the functions that will be modified to implement this functionality is shown below.</p><br><p>As shown in the sequence diagram above, the Frontend User Interface will parse the <code>CREATE INDEX</code> command and call the <code>Frontend::create_index()</code> function in the Frontend Programming Interface. This call is then transferred along to the <a href="/docs/Design/Schema Layer">Schema Layer</a>. Hence, the implementation of the <code>Frontend::create_index()</code> function only involves a call to the <code>Schema::createIndex()</code> function. Similarly, the <code>DROP INDEX</code> command leads to the <code>Frontend::drop_index()</code> function which in turn transfers control to <code>Schema::dropIndex()</code>.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Frontend/Frontend.cpp</summary><div><div class="collapsibleContent_i85q"><p>Implement the following functions looking at their respective design docs</p><ul><li><a href="/docs/Design/Frontend#frontend--create_index"><code>Frontend::create_index()</code></a></li><li><a href="/docs/Design/Frontend#frontend--drop_index"><code>Frontend::drop_index()</code></a></li></ul></div></div></details><p>The <code>Schema::createIndex()</code> function verifies that the relation is open and passes the rel-id and attribute name along to the <code>BPlusTree::bPlusCreate()</code> function to create an index (to be implemented later in this stage).</p><p>The <code>Schema::dropIndex()</code> function fetches the root block of the index on a specified attribute from the attribute cache and then calls the <code>BPlusTree::bPlusDestroy()</code> function to free the index blocks. The corresponding attribute cache entry is then updated to indicate that there no longer exists a B+ tree on the attribute.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Although the <a href="/docs/Design/Schema Layer">Schema Layer</a> function <code>Schema::dropIndex()</code> is responsible for removing the <code>RootBlock</code> field during index deletion, during index creation, the attribute cache entry is updated with the value of the root block in the <a href="/docs/Design/B+ Tree Layer">B+ Tree Layer</a> function <code>BPlusTree::bPlusCreate()</code> (and not in the <code>Schema::createIndex()</code> function).</p></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Schema/Schema.cpp</summary><div><div class="collapsibleContent_i85q"><p>Implement the following functions looking at their respective design docs</p><ul><li><a href="/docs/Design/Schema Layer#schema--createindex"><code>Schema::createIndex()</code></a></li><li><a href="/docs/Design/Schema Layer#schema--dropindex"><code>Schema::dropIndex()</code></a></li></ul></div></div></details><p>We implement the core functionality of this stage in the <a href="/docs/Design/B+ Tree Layer">B+ Tree Layer</a>.</p><p>The <code>BPlusTree::bPlusCreate()</code> is used to create an index on attribute for a relation. It allocates a new index block and sets the <code>RootBlock</code> field in the corresponding attribute cache entry. It then reads every record of the relation and inserts the attribute value into the index using <code>BPlusTree::bPlusInsert()</code>.</p><p>The <code>BPlusTree::bPlusInsert()</code> function is used to insert an entry into the B+ tree of an attribute. It gets the root block of the corresponding tree from the attribute cache and then traverses the tree until the appropriate leaf block is found. If the insertion leads to the splitting of the root block (and hence the creation of a new root block), then this function updates the attribute cache with the new root block.</p><p>The <code>BPlusTree::bPlusDestroy()</code> function recursively traverses all the blocks of the index and frees them using <code>BlockBuffer::releaseBlock()</code>.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>BPlusTree/BPlusTree.cpp</summary><div><div class="collapsibleContent_i85q"><p>Implement the following functions looking at their respective design docs</p><ul><li><a href="/docs/Design/B+ Tree Layer#bplustreebpluscreate"><code>BPlusTree::bPlusCreate()</code></a></li><li><a href="/docs/Design/B+ Tree Layer#bplustreebplusinsert"><code>BPlusTree::bPlusInsert()</code></a></li><li><a href="/docs/Design/B+ Tree Layer#bplustreebplusdestroy"><code>BPlusTree::bPlusDestroy()</code></a></li></ul></div></div></details><p>Lastly, in the <a href="/docs/Design/Block Access Layer">Block Access Layer</a>, we update the <code>insert()</code> method to insert the new record into any existing indexes of the relation using <code>BPlusTree::bPlusInsert()</code>. The <code>deleteRelation()</code> method is updated to free up any indexes associated with the relation by calling <code>BPlusTree::bPlusDestroy()</code>.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>BlockAccess/BlockAccess.cpp</summary><div><div class="collapsibleContent_i85q"><p>Implement the following functions looking at their respective design docs</p><ul><li><a href="/docs/Design/Block Access Layer#blockaccess--insert"><code>BlockAccess::insert()</code></a></li><li><a href="/docs/Design/Block Access Layer#blockaccess--deleterelation"><code>BlockAccess::deleteRelation()</code></a></li></ul></div></div></details><p>And with that, your NITCbase now supports the creation and deletion of indexes! Verify your implementation with the exercises below.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exercises">Exercises<a href="#exercises" class="hash-link" aria-label="Direct link to Exercises" title="Direct link to Exercises">​</a></h2></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Roadmap/Stage10"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Stage 10: B+ Tree Search on Relations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Roadmap/Stage12"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stage 12: Join on Relations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#implementation" class="table-of-contents__link toc-highlight">Implementation</a><ul><li><a href="#cache-update-and-write-back" class="table-of-contents__link toc-highlight">Cache Update and Write-back</a></li><li><a href="#writing-to-index-blocks" class="table-of-contents__link toc-highlight">Writing to Index Blocks</a></li><li><a href="#creating-and-deleting-b-trees" class="table-of-contents__link toc-highlight">Creating and Deleting B+ Trees</a></li></ul></li><li><a href="#exercises" class="table-of-contents__link toc-highlight">Exercises</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/AboutUs">About Us</a></li><li class="footer__item"><a href="https://github.com/NITCbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 National Institute of Technology Calicut. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.03501c79.js"></script>
<script src="/assets/js/main.39433d22.js"></script>
</body>
</html>